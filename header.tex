\documentclass[oneside,12pt]{book}
\usepackage[a5paper,margin=5mm]{geometry}

% Cyrillization
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{indentfirst}

% relative sectioning
\usepackage{ifthen}
\newcounter{secdepth}\setcounter{secdepth}{0}
\newcommand{\secup}{\addtocounter{secdepth}{1}}
\newcommand{\secdown}{\addtocounter{secdepth}{-1}}
\newcommand{\secrel}[1]{
\ifthenelse{\equal{\value{secdepth}}{0}}{\part{#1}}{}
\ifthenelse{\equal{\value{secdepth}}{-1}}{\chapter{#1}}{}
\ifthenelse{\equal{\value{secdepth}}{-2}}{\section{#1}}{}
\ifthenelse{\equal{\value{secdepth}}{-3}}{\subsection{#1}}{}
\ifthenelse{\value{secdepth} < -3}{\subsubsection{#1}}{}
}
\newcommand{\secly}[1]{\section*{#1}\addcontentsline{toc}{section}{#1}}
\newcommand{\subsecly}[1]{\section*{#1}\addcontentsline{toc}{subsection}{#1}}

% listings
\usepackage{listings}
\usepackage{ucs}
\lstset{
basicstyle=\small,
frame=single,
numbers=left,numberstyle=\small,numbersep=2mm,
xleftmargin=3mm,xrightmargin=2mm,
tabsize=4,
keywordstyle=\color{red},
commentstyle=\color{blue},
extendedchars=\true,
inputencoding=utf8,
}
\newcommand{\lst}[1]{\lstinputlisting{#1}}
\newcommand{\lstx}[2]{\lstinputlisting[title=#2]{#1}}
\usepackage{fancyvrb}
\usepackage{framed}
\newcommand{\lstv}[2]{
\begin{flushright}\noindent\small #2\end{flushright}
\begin{oframed}\VerbatimInput[tabsize=4]{#1}\end{oframed}}

% graphics
\usepackage[pdftex]{graphicx}
\newcommand{\fig}[3]{\bigskip\noindent\includegraphics[#3]{#1}\textbf{#2}\bigskip}

% equation fixes
\usepackage{amsmath}